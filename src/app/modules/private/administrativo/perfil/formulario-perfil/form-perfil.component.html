<app-header></app-header>
<p-toast />
<p-confirmDialog/>
<form [formGroup]="perfilForm">
    <p-panel>
        <div class="card flex justify-center">
            <p-breadcrumb class="max-w-full" [model]="items" [home]="home" />
        </div>

        <div class="flex bg-gray-100">

            <div class="w-full flex align-items-center justify-content-center">
                <div class="formgrid grid w-full">
                    <div>
                        <input type="hidden" formControlName="codigo" id="codigo">
                    </div>
                    <div class="field col-12 md:col-3">
                        <label for="descripcion" class="pl-1">Descripción perfil
                            <span *ngIf="isFieldRequired('descripcion')" style="color: red;">*</span>
                        </label>
                        <input id="descripcion" 
                            type="text"
                            pInputText
                            maxlength="100"
                            (input)="filterAlphanumeric($event)"
                            formControlName="descripcion"
                            [ngClass]="(perfilForm.get('descripcion')?.invalid && (perfilForm.get('descripcion')?.touched || perfilForm.get('descripcion')?.dirty)) ? 'ng-invalid ng-dirty w-full' : 'w-full'">
                        <div *ngIf="perfilForm.get('descripcion')?.errors?.['required'] && perfilForm.get('descripcion')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">El campo es requerido</p-message>
                        </div>
                        <div *ngIf="perfilForm.get('descripcion')?.errors?.['maxlength'] && perfilForm.get('descripcion')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">Ha excedido el número máximo de caracteres permitidos</p-message>
                        </div>
                    </div>
                    <div class="field col-12 md:col-2">
                        <label for="abreviatura" class="pl-1">Abreviatura
                            <span *ngIf="isFieldRequired('abreviatura')" style="color: red;">*</span>
                        </label>
                        <input id="abreviatura" 
                            type="text"
                            pInputText
                            maxlength="100"
                            (input)="filterAlphanumeric($event)"
                            formControlName="abreviatura"
                            [ngClass]="(perfilForm.get('abreviatura')?.invalid && (perfilForm.get('abreviatura')?.touched || perfilForm.get('abreviatura')?.dirty)) ? 'ng-invalid ng-dirty w-full' : 'w-full'">
                        <div *ngIf="perfilForm.get('abreviatura')?.errors?.['required'] && perfilForm.get('abreviatura')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">El campo es requerido</p-message>
                        </div>
                        <div *ngIf="perfilForm.get('abreviatura')?.errors?.['maxlength'] && perfilForm.get('abreviatura')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">Ha excedido el número máximo de caracteres permitidos</p-message>
                        </div>
                    </div>
                    <div class="field col-12 md:col-3">
                        <label for="nombreComercial" class="pl-1">Nombre comercial
                            <span *ngIf="isFieldRequired('nombreComercial')" style="color: red;">*</span>
                        </label>
                        <input id="nombreComercial" 
                            type="text"
                            pInputText
                            maxlength="100"
                            (input)="filterAlphanumeric($event)"
                            formControlName="nombreComercial"
                            [ngClass]="(perfilForm.get('nombreComercial')?.invalid && (perfilForm.get('nombreComercial')?.touched || perfilForm.get('nombreComercial')?.dirty)) ? 'ng-invalid ng-dirty w-full' : 'w-full'">
                        <div *ngIf="perfilForm.get('nombreComercial')?.errors?.['required'] && perfilForm.get('nombreComercial')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">El campo es requerido</p-message>
                        </div>
                        <div *ngIf="perfilForm.get('nombreComercial')?.errors?.['maxlength'] && perfilForm.get('nombreComercial')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">Ha excedido el número máximo de caracteres permitidos</p-message>
                        </div>
                    </div>
                    <div class="field col-12 md:col-2">
                        <label for="codigoAplicacion" class="pl-1">Aplicación
                            <span *ngIf="isFieldRequired('codigoAplicacion')" style="color: red;">*</span>
                        </label>
                        <p-select formControlName="codigoAplicacion" 
                                inputId="codigoAplicacion" 
                                [options]="aplicaciones" 
                                optionLabel="descripcion"
                                optionValue="codigo" 
                                placeholder="Selecciona aplicación" 
                                [ngClass]="(perfilForm.get('codigoAplicacion')?.invalid && (perfilForm.get('codigoAplicacion')?.touched || perfilForm.get('codigoAplicacion')?.dirty)) ? 'ng-invalid ng-dirty w-full' : 'w-full'" />
                        <div *ngIf="perfilForm.get('codigoAplicacion')?.errors?.['required'] && perfilForm.get('codigoAplicacion')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">El campo es requerido</p-message>
                        </div>
                    </div>
                    <div class="field col-12 md:col-2">
                        <label for="fechaCaducidad" class="pl-1">Fecha caducidad
                            <span *ngIf="isFieldRequired('fechaCaducidad')" style="color: red;">*</span>
                        </label>
                        <p-datepicker id="fechaCaducidad" 
                                    formControlName="fechaCaducidad" 
                                    readonlyInput="true"
                                    styleClass="w-full"
                                    dateFormat="dd/mm/yy"
                                    placeholder="Selecciona una fecha"/>
                        <div *ngIf="perfilForm.get('fechaCaducidad')?.errors?.['required'] && perfilForm.get('fechaCaducidad')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">El campo es requerido</p-message>
                        </div>
                        <div *ngIf="perfilForm.get('fechaCaducidad')?.errors?.['maxlength'] && perfilForm.get('fechaCaducidad')?.touched" class="p-error">
                            <p-message severity="error" variant="simple" size="small">Ha excedido el número máximo de caracteres permitidos</p-message>
                        </div>
                    </div>
                    
                    <div class="field col-12 md:col-5"></div>
                    <div class="field col-12 md:col-1">
                        <p-button label="Guardar" 
                                pTooltip="Guardar" 
                                variant="outlined"
                                severity="info" 
                                (onClick)="guardar();"
                                [styleClass]="'w-full'"/>
                    </div>
                    <div class="field col-12 md:col-1">
                        <p-button label="Volver" 
                                pTooltip="Volver" 
                                variant="outlined" 
                                severity="contrast" 
                                (onClick)="navigateToFormEntorno()"
                                [styleClass]="'w-full'"/>
                    </div>
                    <div class="field col-12 md:col-5"></div>
                </div>
            </div>

        </div>
    </p-panel>

    
</form>